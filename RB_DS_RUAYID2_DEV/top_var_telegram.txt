SELECT REPLACE( CAST(Date as STRING),'-','_') Date, product, SUM(FactLeads)leads FROM `raiffeisen-owox.RB_DS_TopVar_ASIS.KPI_CPO_Plan_and_Fact_tb` WHERE true AND Date IN UNNEST(GENERATE_DATE_ARRAY(CURRENT_DATE() -29, CURRENT_DATE()-1, INTERVAL 7 DAY)) AND NOT (product IS NULL OR product = 'SME' OR product = 'Other') GROUP BY Date, product ORDER BY DATE, product